Version 4
SHEET 1 1828 1368
WIRE -832 -640 -976 -640
WIRE -816 -640 -832 -640
WIRE -1936 -624 -1984 -624
WIRE -1792 -624 -1856 -624
WIRE -832 -608 -832 -640
WIRE -1888 -576 -1904 -576
WIRE -3376 -560 -3552 -560
WIRE -2400 -560 -2576 -560
WIRE -1376 -560 -1552 -560
WIRE -1904 -544 -1904 -576
WIRE -3424 -528 -3472 -528
WIRE -3024 -528 -3072 -528
WIRE -2896 -528 -2960 -528
WIRE -2880 -528 -2896 -528
WIRE -2448 -528 -2496 -528
WIRE -2112 -528 -2128 -528
WIRE -1984 -528 -1984 -624
WIRE -1984 -528 -2032 -528
WIRE -1936 -528 -1984 -528
WIRE -1424 -528 -1472 -528
WIRE -976 -528 -976 -640
WIRE -1792 -512 -1792 -624
WIRE -1792 -512 -1872 -512
WIRE -1056 -512 -1056 -544
WIRE -1008 -512 -1056 -512
WIRE -3472 -496 -3472 -528
WIRE -2896 -496 -2896 -528
WIRE -2496 -496 -2496 -528
WIRE -1936 -496 -1968 -496
WIRE -1472 -496 -1472 -528
WIRE -832 -496 -832 -528
WIRE -832 -496 -944 -496
WIRE -3552 -480 -3552 -560
WIRE -3504 -480 -3552 -480
WIRE -2576 -480 -2576 -560
WIRE -2528 -480 -2576 -480
WIRE -1552 -480 -1552 -560
WIRE -1504 -480 -1552 -480
WIRE -1168 -480 -1184 -480
WIRE -1056 -480 -1088 -480
WIRE -1008 -480 -1056 -480
WIRE -3376 -464 -3376 -560
WIRE -3376 -464 -3440 -464
WIRE -2400 -464 -2400 -560
WIRE -2400 -464 -2464 -464
WIRE -1376 -464 -1376 -560
WIRE -1376 -464 -1440 -464
WIRE -3504 -448 -3552 -448
WIRE -2528 -448 -2576 -448
WIRE -1504 -448 -1552 -448
WIRE -2112 -432 -2144 -432
WIRE -1984 -432 -2032 -432
WIRE -1968 -432 -1968 -496
WIRE -1968 -432 -1984 -432
WIRE -1984 -400 -1984 -432
WIRE -1056 -400 -1056 -480
WIRE -1008 -400 -1056 -400
WIRE -832 -400 -832 -496
WIRE -832 -400 -928 -400
WIRE -2896 -368 -2896 -416
WIRE -2896 -368 -2944 -368
WIRE -1984 -288 -1984 -320
WIRE -3232 128 -3280 128
WIRE -2528 128 -2576 128
WIRE -1904 128 -1952 128
WIRE -3280 176 -3280 128
WIRE -2576 176 -2576 128
WIRE -1952 176 -1952 128
WIRE -3280 304 -3280 256
WIRE -2576 304 -2576 256
WIRE -1952 304 -1952 256
WIRE -3232 416 -3280 416
WIRE -2528 416 -2576 416
WIRE -1904 416 -1952 416
WIRE -3280 464 -3280 416
WIRE -2576 464 -2576 416
WIRE -1952 464 -1952 416
WIRE -3280 592 -3280 544
WIRE -2576 592 -2576 544
WIRE -1952 592 -1952 544
WIRE -1904 688 -1952 688
WIRE -3232 704 -3280 704
WIRE -2528 704 -2576 704
WIRE -1952 736 -1952 688
WIRE -3280 752 -3280 704
WIRE -2576 752 -2576 704
WIRE -1952 864 -1952 816
WIRE -3280 880 -3280 832
WIRE -2576 880 -2576 832
FLAG -816 -640 VCC
FLAG -1056 -544 VBias
FLAG -3280 880 0
FLAG -1952 592 0
FLAG -3232 704 Vw
FLAG -1904 416 Vbias
FLAG -1952 304 0
FLAG -1904 128 VCC
FLAG -976 -464 0
FLAG -3072 -528 VBuf1
FLAG -2880 -528 Vf
FLAG -1184 -480 VBuf3
FLAG -3472 -432 0
FLAG -3424 -528 VCC
FLAG -3376 -464 VBuf1
FLAG -3552 -448 Vw
FLAG -2496 -432 0
FLAG -2448 -528 VCC
FLAG -2400 -464 VBuf2
FLAG -2576 -448 Vf
FLAG -1888 -576 VCC
FLAG -1792 -512 Va
FLAG -1472 -432 0
FLAG -1424 -528 VCC
FLAG -1376 -464 VBuf3
FLAG -1552 -448 Va
FLAG -1904 -480 0
FLAG -2128 -528 0
FLAG -832 -496 VComp
FLAG -3280 592 0
FLAG -3232 416 Vb
FLAG -3280 304 0
FLAG -3232 128 Vg
FLAG -2576 880 0
FLAG -2528 704 Vw_off
FLAG -2576 592 0
FLAG -2528 416 Vb_off
FLAG -2576 304 0
FLAG -2528 128 Vg_off
FLAG -2144 -432 VBuf2
FLAG -1952 864 0
FLAG -1904 688 V_offset
FLAG -1984 -288 0
FLAG -2944 -368 V_offset
SYMBOL res -1072 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res -912 -416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res -848 -624 R0
SYMATTR InstName R3
SYMATTR Value 3.3k
SYMBOL voltage -1952 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vbias
SYMATTR Value 3V
SYMBOL voltage -3280 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 -205 89 Left 2
WINDOW 3 26 103 Left 2
SYMATTR Value PWL file="./PWL Sources/on-white-2s.txt"
SYMATTR InstName Vwhite
SYMBOL voltage -1952 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply
SYMATTR Value 5V
SYMBOL OpAmps\\UniversalOpAmp4 -976 -496 R0
SYMATTR InstName U2
SYMBOL res -2912 -512 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL cap -2960 -544 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1.6µ
SYMBOL OpAmps\\UniversalOpAmp4 -3472 -464 R0
SYMATTR InstName U1
SYMBOL OpAmps\\UniversalOpAmp4 -2496 -464 R0
SYMATTR InstName U3
SYMBOL OpAmps\\UniversalOpAmp4 -1904 -512 R0
SYMATTR InstName U4
SYMBOL res -1840 -640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -2016 -544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 40k
SYMBOL OpAmps\\UniversalOpAmp4 -1472 -464 R0
SYMATTR InstName U5
SYMBOL voltage -3280 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/on-black-2s.txt"
SYMATTR InstName Vblack
SYMBOL voltage -3280 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/on-green-2s.txt"
SYMATTR InstName Vgreen
SYMBOL voltage -2576 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 -205 89 Left 2
WINDOW 3 26 103 Left 2
SYMATTR Value PWL file="./PWL Sources/off-white-2s.txt"
SYMATTR InstName Vwhite1
SYMBOL voltage -2576 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/off-black-2s.txt"
SYMATTR InstName Vblack1
SYMBOL voltage -2576 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/off-green-2s.txt"
SYMATTR InstName Vgreen1
SYMBOL res -2016 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 40k
SYMBOL res -2000 -416 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL voltage -1952 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Voffset
SYMATTR Value 0.5V
TEXT -1248 -680 Left 2 ;PWM regenerator
TEXT -1712 128 Left 2 !.tran 0 250m 0 0.01
TEXT -3232 -632 Left 2 ;High pass filter (Cf = 10Hz)
TEXT -3624 -632 Left 2 ;Signal Buffer (Stage 1)
TEXT -2648 -632 Left 2 ;Signal Buffer (Stage 2)
TEXT -1624 -632 Left 2 ;Signal Buffer (Stage 3)
TEXT -2240 -712 Left 2 ;Signal amplification
TEXT -3400 504 Left 2 ;Black
TEXT -3408 792 Left 2 ;White
TEXT -3408 216 Left 2 ;Green
TEXT -3280 16 Left 2 ;Signal Waveforms
TEXT -2080 16 Left 2 ;Supply Voltages
TEXT -1712 16 Left 2 ;SPICE Directives
TEXT -2696 504 Left 2 ;Black
TEXT -2704 792 Left 2 ;White
TEXT -2704 216 Left 2 ;Green
TEXT -2704 16 Left 2 ;Signal Waveforms
RECTANGLE Normal -736 -352 -1248 -656 2
RECTANGLE Normal -2720 -304 -3232 -608 2
RECTANGLE Normal -3312 -352 -3632 -608 2
RECTANGLE Normal -2336 -352 -2656 -608 2
RECTANGLE Normal -1312 -352 -1632 -608 2
RECTANGLE Normal -1408 960 -3424 -64 2
RECTANGLE Normal -1664 -208 -2240 -688 2
