Version 4
SHEET 1 1828 1368
WIRE -1088 -608 -1152 -608
WIRE -944 -608 -1008 -608
WIRE -3376 -560 -3552 -560
WIRE -1296 -560 -1392 -560
WIRE -1152 -560 -1152 -608
WIRE -1152 -560 -1216 -560
WIRE -2944 -544 -2992 -544
WIRE -2800 -544 -2864 -544
WIRE -2432 -544 -2480 -544
WIRE -2304 -544 -2368 -544
WIRE -2288 -544 -2304 -544
WIRE -3424 -528 -3472 -528
WIRE -2304 -512 -2304 -544
WIRE -1152 -512 -1152 -560
WIRE -1088 -512 -1152 -512
WIRE -3472 -496 -3472 -528
WIRE -2896 -496 -2912 -496
WIRE -1792 -496 -1792 -544
WIRE -944 -496 -944 -608
WIRE -944 -496 -1024 -496
WIRE -3552 -480 -3552 -560
WIRE -3504 -480 -3552 -480
WIRE -1872 -480 -1872 -512
WIRE -1824 -480 -1872 -480
WIRE -1296 -480 -1392 -480
WIRE -1152 -480 -1216 -480
WIRE -1088 -480 -1152 -480
WIRE -3376 -464 -3376 -560
WIRE -3376 -464 -3440 -464
WIRE -2912 -464 -2912 -496
WIRE -1648 -464 -1760 -464
WIRE -3504 -448 -3552 -448
WIRE -3120 -448 -3136 -448
WIRE -2992 -448 -2992 -544
WIRE -2992 -448 -3040 -448
WIRE -2944 -448 -2992 -448
WIRE -1824 -448 -1920 -448
WIRE -2800 -432 -2800 -544
WIRE -2800 -432 -2880 -432
WIRE -2944 -416 -2976 -416
WIRE -1152 -416 -1152 -480
WIRE -2304 -384 -2304 -432
WIRE -3120 -352 -3152 -352
WIRE -2992 -352 -3040 -352
WIRE -2976 -352 -2976 -416
WIRE -2976 -352 -2992 -352
WIRE -2992 -320 -2992 -352
WIRE -1152 -304 -1152 -352
WIRE -2992 -208 -2992 -240
WIRE -3232 128 -3280 128
WIRE -2528 128 -2576 128
WIRE -1904 128 -1952 128
WIRE -3280 176 -3280 128
WIRE -2576 176 -2576 128
WIRE -1952 176 -1952 128
WIRE -3280 304 -3280 256
WIRE -2576 304 -2576 256
WIRE -1952 304 -1952 256
WIRE -3232 416 -3280 416
WIRE -2528 416 -2576 416
WIRE -1904 416 -1952 416
WIRE -3280 464 -3280 416
WIRE -2576 464 -2576 416
WIRE -1952 464 -1952 416
WIRE -3280 592 -3280 544
WIRE -2576 592 -2576 544
WIRE -1952 592 -1952 544
WIRE -1904 688 -1952 688
WIRE -3232 704 -3280 704
WIRE -2528 704 -2576 704
WIRE -1952 736 -1952 688
WIRE -3280 752 -3280 704
WIRE -2576 752 -2576 704
WIRE -1952 864 -1952 816
WIRE -3280 880 -3280 832
WIRE -2576 880 -2576 832
FLAG -1792 -544 VCC
FLAG -1872 -512 VBias
FLAG -3280 880 0
FLAG -1952 592 0
FLAG -3232 704 Vw
FLAG -1904 416 Vbias
FLAG -1952 304 0
FLAG -1904 128 VCC
FLAG -1792 -432 0
FLAG -2480 -544 Va
FLAG -2288 -544 Vf
FLAG -1920 -448 Vf
FLAG -3472 -432 0
FLAG -3424 -528 VCC
FLAG -3376 -464 VBuf1
FLAG -3552 -448 Vw
FLAG -2896 -496 VCC
FLAG -2800 -432 Va
FLAG -2912 -400 0
FLAG -3136 -448 0
FLAG -1648 -464 VComp
FLAG -3280 592 0
FLAG -3232 416 Vb
FLAG -3280 304 0
FLAG -3232 128 Vg
FLAG -2576 880 0
FLAG -2528 704 Vw_off
FLAG -2576 592 0
FLAG -2528 416 Vb_off
FLAG -2576 304 0
FLAG -2528 128 Vg_off
FLAG -3152 -352 VBuf1
FLAG -1952 864 0
FLAG -1904 688 V_offset
FLAG -2992 -208 V_offset
FLAG -2304 -384 0
FLAG -1392 -480 VComp
FLAG -1152 -304 0
FLAG -1392 -560 0
FLAG -1056 -464 0
FLAG -1056 -528 VCC
FLAG -944 -496 Is_white
SYMBOL voltage -1952 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vbias
SYMATTR Value 0.5
SYMBOL voltage -3280 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 -205 89 Left 2
WINDOW 3 26 103 Left 2
SYMATTR Value PWL file="./PWL Sources/on-white-2s.txt"
SYMATTR InstName Vwhite
SYMBOL voltage -1952 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply
SYMATTR Value 5V
SYMBOL OpAmps\\UniversalOpAmp4 -1792 -464 R0
SYMATTR InstName U2
SYMBOL res -2320 -528 R0
SYMATTR InstName R4
SYMATTR Value 30k
SYMBOL cap -2368 -560 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 47n
SYMBOL OpAmps\\UniversalOpAmp4 -3472 -464 R0
SYMATTR InstName U1
SYMBOL OpAmps\\UniversalOpAmp4 -2912 -432 R0
SYMATTR InstName U4
SYMBOL res -2848 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -3024 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 40k
SYMBOL voltage -3280 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/on-black-2s.txt"
SYMATTR InstName Vblack
SYMBOL voltage -3280 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/on-green-2s.txt"
SYMATTR InstName Vgreen
SYMBOL voltage -2576 736 R0
WINDOW 123 0 0 Left 0
WINDOW 39 -205 89 Left 2
WINDOW 3 26 103 Left 2
SYMATTR Value PWL file="./PWL Sources/off-white-2s.txt"
SYMATTR InstName Vwhite1
SYMBOL voltage -2576 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/off-black-2s.txt"
SYMATTR InstName Vblack1
SYMBOL voltage -2576 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 27 103 Left 2
SYMATTR Value PWL file="./PWL Sources/off-green-2s.txt"
SYMATTR InstName Vgreen1
SYMBOL res -3024 -368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 40k
SYMBOL res -3008 -336 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL voltage -1952 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Voffset
SYMATTR Value 0.5
SYMBOL res -1200 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL cap -1168 -416 R0
SYMATTR InstName C4
SYMATTR Value 1.6µ
SYMBOL OpAmps\\UniversalOpAmp4 -1056 -496 R0
SYMATTR InstName U7
SYMBOL res -992 -624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL res -1200 -576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 20k
TEXT -2064 -648 Left 2 ;PWM regenerator
TEXT -1712 128 Left 2 !.tran 0 250m 0 0.01
TEXT -2640 -648 Left 2 ;High pass filter (Cf = 110Hz)
TEXT -3624 -632 Left 2 ;Signal Buffer (Stage 1)
TEXT -3240 -640 Left 2 ;Signal amplification
TEXT -3400 504 Left 2 ;Black
TEXT -3408 792 Left 2 ;White
TEXT -3408 216 Left 2 ;Green
TEXT -3280 16 Left 2 ;Signal Waveforms
TEXT -2080 16 Left 2 ;Supply Voltages
TEXT -1712 16 Left 2 ;SPICE Directives
TEXT -2696 504 Left 2 ;Black
TEXT -2704 792 Left 2 ;White
TEXT -2704 216 Left 2 ;Green
TEXT -2704 16 Left 2 ;Signal Waveforms
TEXT -1472 -688 Left 2 ;Digital output (Low pass filter Cf = 10Hz & Amplication Gain = 5)
RECTANGLE Normal -1552 -320 -2064 -624 2
RECTANGLE Normal -2128 -320 -2640 -624 2
RECTANGLE Normal -3312 -352 -3632 -608 2
RECTANGLE Normal -1408 960 -3424 -64 2
RECTANGLE Normal -2672 -128 -3248 -608 2
RECTANGLE Normal -912 -272 -1472 -656 2
